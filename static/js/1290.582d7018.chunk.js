"use strict";(self.webpackChunkcity_walk_app=self.webpackChunkcity_walk_app||[]).push([[1290],{69329:(t,e,i)=>{function s(t,e,i){i=i||2;var s,o,h,a,l,c,d,v=e&&e.length,y=v?e[0]*i:t.length,u=r(t,0,y,i,!0),_=[];if(!u||u.next===u.prev)return _;if(v&&(u=p(t,e,u,i)),t.length>80*i){s=h=t[0],o=a=t[1];for(var g=i;g<y;g+=i)(l=t[g])<s&&(s=l),(c=t[g+1])<o&&(o=c),l>h&&(h=l),c>a&&(a=c);d=0!==(d=Math.max(h-s,a-o))?1/d:0}return n(u,_,i,s,o,d),_}function r(t,e,i,s,r){var o,n;if(r===Z(t,e,i,s)>0)for(o=e;o<i;o+=s)n=E(o,t[o],t[o+1],n);else for(o=i-s;o>=e;o-=s)n=E(o,t[o],t[o+1],n);if(n&&G(n,n.next)){var h=n.next;T(n),n=h}return n}function o(t,e){if(!t)return t;e||(e=t);var i,s=t;do{if(i=!1,s.steiner||!G(s,s.next)&&0!==w(s.prev,s,s.next))s=s.next;else{var r=s.prev;if(T(s),(s=e=r)===s.next)break;i=!0}}while(i||s!==e);return e}function n(t,e,i,s,r,p,d){if(t){!d&&p&&_(t,s,r,p);for(var v,y,u=t;t.prev!==t.next;)if(v=t.prev,y=t.next,p?a(t,s,r,p):h(t))e.push(v.i/i),e.push(t.i/i),e.push(y.i/i),T(t),t=y.next,u=y.next;else if((t=y)===u){d?1===d?n(t=l(o(t),e,i),e,i,s,r,p,2):2===d&&c(t,e,i,s,r,p):n(o(t),e,i,s,r,p,1);break}}}function h(t){var e=t.prev,i=t,s=t.next;if(w(e,i,s)>=0)return!1;for(var r=t.next.next;r!==t.prev;){if(m(e.x,e.y,i.x,i.y,s.x,s.y,r.x,r.y)&&w(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function a(t,e,i,s){var r=t.prev,o=t,n=t.next;if(w(r,o,n)>=0)return!1;for(var h=r.x<o.x?r.x<n.x?r.x:n.x:o.x<n.x?o.x:n.x,a=r.y<o.y?r.y<n.y?r.y:n.y:o.y<n.y?o.y:n.y,l=r.x>o.x?r.x>n.x?r.x:n.x:o.x>n.x?o.x:n.x,c=r.y>o.y?r.y>n.y?r.y:n.y:o.y>n.y?o.y:n.y,p=g(h,a,e,i,s),d=g(l,c,e,i,s),v=t.prevZ,y=t.nextZ;v&&v.z>=p&&y&&y.z<=d;){if(v!==t.prev&&v!==t.next&&m(r.x,r.y,o.x,o.y,n.x,n.y,v.x,v.y)&&w(v.prev,v,v.next)>=0)return!1;if(v=v.prevZ,y!==t.prev&&y!==t.next&&m(r.x,r.y,o.x,o.y,n.x,n.y,y.x,y.y)&&w(y.prev,y,y.next)>=0)return!1;y=y.nextZ}for(;v&&v.z>=p;){if(v!==t.prev&&v!==t.next&&m(r.x,r.y,o.x,o.y,n.x,n.y,v.x,v.y)&&w(v.prev,v,v.next)>=0)return!1;v=v.prevZ}for(;y&&y.z<=d;){if(y!==t.prev&&y!==t.next&&m(r.x,r.y,o.x,o.y,n.x,n.y,y.x,y.y)&&w(y.prev,y,y.next)>=0)return!1;y=y.nextZ}return!0}function l(t,e,i){var s=t;do{var r=s.prev,n=s.next.next;!G(r,n)&&M(r,s,s.next,n)&&V(r,n)&&V(n,r)&&(e.push(r.i/i),e.push(s.i/i),e.push(n.i/i),T(s),T(s.next),s=t=n),s=s.next}while(s!==t);return o(s)}function c(t,e,i,s,r,h){var a=t;do{for(var l=a.next.next;l!==a.prev;){if(a.i!==l.i&&f(a,l)){var c=O(a,l);return a=o(a,a.next),c=o(c,c.next),n(a,e,i,s,r,h),void n(c,e,i,s,r,h)}l=l.next}a=a.next}while(a!==t)}function p(t,e,i,s){var n,h,a,l=[];for(n=0,h=e.length;n<h;n++)(a=r(t,e[n]*s,n<h-1?e[n+1]*s:t.length,s,!1))===a.next&&(a.steiner=!0),l.push(x(a));for(l.sort(d),n=0;n<l.length;n++)i=o(i=y(l[n],i),i.next);return i}function d(t,e){return t.x-e.x}function v(t){if(t.next.prev===t)return t;let e=t;for(;;){const i=e.next;if(i.prev===e||i===e||i===t)break;e=i}return e}function y(t,e){var i=function(t,e){var i,s=e,r=t.x,o=t.y,n=-1/0;do{if(o<=s.y&&o>=s.next.y&&s.next.y!==s.y){var h=s.x+(o-s.y)*(s.next.x-s.x)/(s.next.y-s.y);if(h<=r&&h>n){if(n=h,h===r){if(o===s.y)return s;if(o===s.next.y)return s.next}i=s.x<s.next.x?s:s.next}}s=s.next}while(s!==e);if(!i)return null;if(r===n)return i;var a,l=i,c=i.x,p=i.y,d=1/0;s=i;do{r>=s.x&&s.x>=c&&r!==s.x&&m(o<p?r:n,o,c,p,o<p?n:r,o,s.x,s.y)&&(a=Math.abs(o-s.y)/(r-s.x),V(s,t)&&(a<d||a===d&&(s.x>i.x||s.x===i.x&&u(i,s)))&&(i=s,d=a)),s=s.next}while(s!==l);return i}(t,e);if(!i)return e;var s=O(i,t),r=o(i,i.next);let n=v(s);return o(n,n.next),r=v(r),v(e===i?r:e)}function u(t,e){return w(t.prev,t,e.prev)<0&&w(e.next,t,t.next)<0}function _(t,e,i,s){var r=t;do{null===r.z&&(r.z=g(r.x,r.y,e,i,s)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,function(t){var e,i,s,r,o,n,h,a,l=1;do{for(i=t,t=null,o=null,n=0;i;){for(n++,s=i,h=0,e=0;e<l&&(h++,s=s.nextZ);e++);for(a=l;h>0||a>0&&s;)0!==h&&(0===a||!s||i.z<=s.z)?(r=i,i=i.nextZ,h--):(r=s,s=s.nextZ,a--),o?o.nextZ=r:t=r,r.prevZ=o,o=r;i=s}o.nextZ=null,l*=2}while(n>1)}(r)}function g(t,e,i,s,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)*r)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-s)*r)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function x(t){var e=t,i=t;do{(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next}while(e!==t);return i}function m(t,e,i,s,r,o,n,h){return(r-n)*(e-h)-(t-n)*(o-h)>=0&&(t-n)*(s-h)-(i-n)*(e-h)>=0&&(i-n)*(o-h)-(r-n)*(s-h)>=0}function f(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var i=t;do{if(i.i!==t.i&&i.next.i!==t.i&&i.i!==e.i&&i.next.i!==e.i&&M(i,i.next,t,e))return!0;i=i.next}while(i!==t);return!1}(t,e)&&(V(t,e)&&V(e,t)&&function(t,e){var i=t,s=!1,r=(t.x+e.x)/2,o=(t.y+e.y)/2;do{i.y>o!=i.next.y>o&&i.next.y!==i.y&&r<(i.next.x-i.x)*(o-i.y)/(i.next.y-i.y)+i.x&&(s=!s),i=i.next}while(i!==t);return s}(t,e)&&(w(t.prev,t,e.prev)||w(t,e.prev,e))||G(t,e)&&w(t.prev,t,t.next)>0&&w(e.prev,e,e.next)>0)}function w(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function G(t,e){return t.x===e.x&&t.y===e.y}function M(t,e,i,s){var r=k(w(t,e,i)),o=k(w(t,e,s)),n=k(w(i,s,t)),h=k(w(i,s,e));return r!==o&&n!==h||!(0!==r||!b(t,i,e))||!(0!==o||!b(t,s,e))||!(0!==n||!b(i,t,s))||!(0!==h||!b(i,e,s))}function b(t,e,i){return e.x<=Math.max(t.x,i.x)&&e.x>=Math.min(t.x,i.x)&&e.y<=Math.max(t.y,i.y)&&e.y>=Math.min(t.y,i.y)}function k(t){return t>0?1:t<0?-1:0}function V(t,e){return w(t.prev,t,t.next)<0?w(t,e,t.next)>=0&&w(t,t.prev,e)>=0:w(t,e,t.prev)<0||w(t,t.next,e)<0}function O(t,e){var i=new S(t.i,t.x,t.y),s=new S(e.i,e.x,e.y),r=t.next,o=e.prev;return t.next=e,e.prev=t,i.next=r,r.prev=i,s.next=i,i.prev=s,o.next=s,s.prev=o,s}function E(t,e,i,s){var r=new S(t,e,i);return s?(r.next=s.next,r.prev=s,s.next.prev=r,s.next=r):(r.prev=r,r.next=r),r}function T(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function S(t,e,i){this.i=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Z(t,e,i,s){for(var r=0,o=e,n=i-s;o<i;o+=s)r+=(t[n]-t[o])*(t[o+1]+t[n+1]),n=o;return r}i.d(e,{e:()=>s}),s.deviation=function(t,e,i,s){var r=e&&e.length,o=r?e[0]*i:t.length,n=Math.abs(Z(t,0,o,i));if(r)for(var h=0,a=e.length;h<a;h++){var l=e[h]*i,c=h<a-1?e[h+1]*i:t.length;n-=Math.abs(Z(t,l,c,i))}var p=0;for(h=0;h<s.length;h+=3){var d=s[h]*i,v=s[h+1]*i,y=s[h+2]*i;p+=Math.abs((t[d]-t[y])*(t[v+1]-t[d+1])-(t[d]-t[v])*(t[y+1]-t[d+1]))}return 0===n&&0===p?0:Math.abs((p-n)/n)},s.flatten=function(t){for(var e=t[0][0].length,i={vertices:[],holes:[],dimensions:e},s=0,r=0;r<t.length;r++){for(var o=0;o<t[r].length;o++)for(var n=0;n<e;n++)i.vertices.push(t[r][o][n]);r>0&&(s+=t[r-1].length,i.holes.push(s))}return i}},73218:(t,e,i)=>{i.r(e),i.d(e,{default:()=>Z});var s=i(70273),r=(i(95026),i(34429)),o=i(65930),n=i(73896),h=i(67519),a=(i(27052),i(11434),i(55292)),l=i(26391),c=i(92813),p=i(8402),d=i(86586);class v{constructor(t,e,i,s,r){this.graphic=t,this.index=e,this.x=i,this.y=s,this.viewEvent=r,this.type="graphic-click"}}class y{constructor(t,e,i,s,r){this.graphic=t,this.index=e,this.x=i,this.y=s,this.viewEvent=r,this.type="graphic-double-click"}}class u{constructor(t,e,i,s,r,o,n,h,a,l){this.graphic=t,this.allGraphics=e,this.index=i,this.x=s,this.y=r,this.dx=o,this.dy=n,this.totalDx=h,this.totalDy=a,this.viewEvent=l,this.defaultPrevented=!1,this.type="graphic-move-start"}preventDefault(){this.defaultPrevented=!0}}class _{constructor(t,e,i,s,r,o,n,h,a,l){this.graphic=t,this.allGraphics=e,this.index=i,this.x=s,this.y=r,this.dx=o,this.dy=n,this.totalDx=h,this.totalDy=a,this.viewEvent=l,this.defaultPrevented=!1,this.type="graphic-move"}preventDefault(){this.defaultPrevented=!0}}class g{constructor(t,e,i,s,r,o,n,h,a,l){this.graphic=t,this.allGraphics=e,this.index=i,this.x=s,this.y=r,this.dx=o,this.dy=n,this.totalDx=h,this.totalDy=a,this.viewEvent=l,this.defaultPrevented=!1,this.type="graphic-move-stop"}preventDefault(){this.defaultPrevented=!0}}class x{constructor(t,e,i,s,r){this.graphic=t,this.index=e,this.x=i,this.y=s,this.viewEvent=r,this.type="graphic-pointer-over"}}class m{constructor(t,e,i,s,r){this.graphic=t,this.index=e,this.x=i,this.y=s,this.viewEvent=r,this.type="graphic-pointer-out"}}class f{constructor(t,e,i,s,r){this.graphic=t,this.index=e,this.x=i,this.y=s,this.viewEvent=r,this.type="graphic-pointer-down"}}class w{constructor(t,e,i,s,r){this.graphic=t,this.index=e,this.x=i,this.y=s,this.viewEvent=r,this.type="graphic-pointer-up"}}var G=i(24864),M=i(73614),b=i(44534),k=i(69806),V=i(67553),O=i(68597);const E="indicator-symbols";let T=class extends r.A.EventedAccessor{constructor(t){super(t),this._activeGraphic=null,this._dragEvent=null,this._hoverGraphic=null,this._indicators=[],this._initialDragGeometry=null,this._manipulators=[],this._layerViews=null,this.type="graphic-mover",this.callbacks={onGraphicClick(){},onGraphicDoubleClick(){},onGraphicMoveStart(){},onGraphicMove(){},onGraphicMoveStop(){},onGraphicPointerOver(){},onGraphicPointerOut(){},onGraphicPointerDown(){},onGraphicPointerUp(){}},this.enableMoveAllGraphics=!1,this.graphics=[],this.indicatorsEnabled=!1,this.layer=new l.A({listMode:"hide",internal:!0,title:"GraphicMover highlight layer"}),this.view=null}initialize(){(0,d.Y)(this.view,this.layer),this._highlightHelper=new p.A({view:this.view}),this.refresh(),this.addHandles([(0,n.wB)((()=>this.graphics.length),(()=>this.refresh())),(0,n.z7)((()=>this.view?.ready),(()=>{this.addHandles([this.view.on("immediate-click",(t=>this._clickHandler(t)),G.o.TOOL),this.view.on("double-click",(t=>this._doubleClickHandler(t)),G.o.TOOL),this.view.on("pointer-down",(t=>this._pointerDownHandler(t)),G.o.TOOL),this.view.on("pointer-move",(t=>this._pointerMoveHandler(t)),G.o.TOOL),this.view.on("pointer-up",(t=>this._pointerUpHandler(t)),G.o.TOOL),this.view.on("drag",(t=>this._dragHandler(t)),G.o.TOOL),this.view.on("key-down",(t=>this._keyDownHandler(t)),G.o.TOOL)])}),{once:!0,initial:!0}),(0,n.wB)((()=>this.view),(t=>{this._highlightHelper.removeAll(),this._highlightHelper.view=t}))])}destroy(){this._removeIndicators(),this.view.map?.remove(this.layer),this.layer.destroy(),this.reset(),this._manipulators.forEach((t=>t.destroy())),this._manipulators=null}set highlightsEnabled(t){this._highlightHelper?.removeAll(),this._set("highlightsEnabled",t),t&&this._highlightHelper?.add(this.graphics)}get state(){const t=this.view.ready,e=this.graphics.length>0,i=this._activeGraphic;return t&&e?i?"moving":"active":t?"ready":"disabled"}refresh(){this.reset(),this._setup()}reset(){this._activeGraphic=null,this._hoverGraphic=null,this._dragEvent=null,this._highlightHelper.removeAll()}updateGeometry(t,e){const i=this.graphics[t];i&&(i.set("geometry",e),this._setUpIndicators())}_setup(){this._setUpHighlights(),this._setUpIndicators(),this._setUpManipulators(),this._syncLayerViews()}_clickHandler(t){const e=this._findTargetGraphic((0,b.ZV)(t));if(e){const i=new v(e,this.graphics.indexOf(e),t.x,t.y,t);this.emit("graphic-click",i),this.callbacks.onGraphicClick&&this.callbacks.onGraphicClick(i)}}_doubleClickHandler(t){const e=this._findTargetGraphic((0,b.ZV)(t));if(e){const i=new y(e,this.graphics.indexOf(e),t.x,t.y,t);this.emit("graphic-double-click",i),this.callbacks.onGraphicDoubleClick&&this.callbacks.onGraphicDoubleClick(i)}}_pointerDownHandler(t){const e=this._findTargetGraphic((0,b.ZV)(t));if(e){this._activeGraphic=e;const{x:i,y:s}=t,r=new f(e,this.graphics.indexOf(e),i,s,t);this.emit("graphic-pointer-down",r),this.callbacks.onGraphicPointerDown&&this.callbacks.onGraphicPointerDown(r)}else this._activeGraphic=null}_pointerUpHandler(t){if(this._activeGraphic){const{x:e,y:i}=t,s=this.graphics.indexOf(this._activeGraphic),r=new w(this._activeGraphic,s,e,i,t);this.emit("graphic-pointer-up",r),this.callbacks.onGraphicPointerUp&&this.callbacks.onGraphicPointerUp(r)}}_pointerMoveHandler(t){if(this._dragEvent)return;const e=this._findTargetGraphic((0,b.ZV)(t));if(e){const{x:i,y:s}=t;if(this._hoverGraphic){if(this._hoverGraphic===e)return;const r=this.graphics.indexOf(this._hoverGraphic),o=new m(this.graphics[r],r,i,s,t);this._hoverGraphic=null,this.emit("graphic-pointer-out",o),this.callbacks.onGraphicPointerOut&&this.callbacks.onGraphicPointerOut(o)}const r=this.graphics.indexOf(e),o=new x(e,r,i,s,t);return this._hoverGraphic=e,this.emit("graphic-pointer-over",o),void(this.callbacks.onGraphicPointerOver&&this.callbacks.onGraphicPointerOver(o))}if(this._hoverGraphic){const{x:e,y:i}=t,s=this.graphics.indexOf(this._hoverGraphic),r=new m(this.graphics[s],s,e,i,t);this._hoverGraphic=null,this.emit("graphic-pointer-out",r),this.callbacks.onGraphicPointerOut&&this.callbacks.onGraphicPointerOut(r)}}_dragHandler(t){if("start"!==t.action&&!this._dragEvent||!this._activeGraphic?.geometry)return;"start"===t.action&&this._removeIndicators(),t.stopPropagation();const{action:e,x:i,y:s}=t,r=this.graphics.indexOf(this._activeGraphic),n=this._dragEvent?i-this._dragEvent.x:0,h=this._dragEvent?s-this._dragEvent.y:0,a=i-t.origin.x,l=s-t.origin.y,p="start"===e?this._activeGraphic.geometry:this._initialDragGeometry,d=(0,c.lR)(p,a,l,this.view);if(this._activeGraphic.geometry=d,this.enableMoveAllGraphics&&this.graphics.forEach((t=>{t!==this._activeGraphic&&(t.geometry=(0,c.lR)(t.geometry,n,h,this.view))})),this._dragEvent=t,"start"===e){this._initialDragGeometry=(0,o.o8)(p);const e=new u(this._activeGraphic,this.graphics,r,i,s,n,h,a,l,t);this.emit("graphic-move-start",e),this.callbacks.onGraphicMoveStart&&this.callbacks.onGraphicMoveStart(e),e.defaultPrevented&&this._activeGraphic.set("geometry",p)}else if("update"===e){const e=new _(this._activeGraphic,this.graphics,r,i,s,n,h,a,l,t);this.emit("graphic-move",e),this.callbacks.onGraphicMove&&this.callbacks.onGraphicMove(e),e.defaultPrevented&&(this._activeGraphic.geometry=p)}else{const e=new g(this._activeGraphic,this.graphics,r,i,s,n,h,a,l,t);this._dragEvent=null,this._activeGraphic=null,this._setUpIndicators(),this.emit("graphic-move-stop",e),this.callbacks.onGraphicMoveStop&&this.callbacks.onGraphicMoveStop(e),e.defaultPrevented&&(this.graphics[r].set("geometry",this._initialDragGeometry),this._setUpIndicators()),this._initialDragGeometry=null}}_keyDownHandler(t){"a"!==t.key&&"d"!==t.key&&"n"!==t.key||"moving"!==this.state||t.stopPropagation()}_findTargetGraphic(t){const e=this.view.toMap(t),i=this.graphics;let s=null,r=Number.MAX_VALUE;this._syncLayerViews();const o=this._layerViews.flatMap((t=>"graphicsViews"in t?Array.from(t.graphicsViews(),(t=>t.hitTest(e))).flat():t.graphicsView.hitTest(e))).filter((t=>i.includes(t))).sort(((t,e)=>i.indexOf(t)-i.indexOf(e)));return o.length?o[0]:(this._manipulators.forEach((e=>{const i=e.intersectionDistance(t);null!=i&&i<r&&(r=i,s=e.graphic)})),s)}_syncLayerViews(){this._layerViews=[];const t=new Set;for(const e of this.graphics){const i=(0,d.i)(this.view,e.layer);i&&t.add(i)}this._layerViews=[...t]}_setUpManipulators(){const{graphics:t,view:e}=this;this._manipulators.forEach((t=>t.destroy())),this._manipulators=t.length?t.map((t=>new M.l({graphic:t,view:e}))):[]}_setUpHighlights(){this.highlightsEnabled&&this._highlightHelper.add(this.graphics)}_setUpIndicators(){if(this._removeIndicators(),this.indicatorsEnabled){for(const t of this.graphics){const e=t.clone();e.symbol=S(t),this._indicators.push(e),this.addHandles((0,n.wB)((()=>t.symbol),(()=>this._setUpIndicators())),E)}this.layer.addMany(this._indicators)}}_removeIndicators(){this.removeHandles(E),this._indicators.length&&(this.layer.removeMany(this._indicators),this._indicators.forEach((t=>t.destroy())),this._indicators=[])}};function S(t){if(null==t.symbol)return null;switch(t.symbol.type){case"cim":return new k.default({style:"circle",size:12,color:[0,0,0,0],outline:{color:[255,127,0,1],width:1}});case"picture-marker":{const{xoffset:e,yoffset:i,height:s,width:r}=t.symbol,o=s===r?r:Math.max(s,r);return new k.default({xoffset:e,yoffset:i,size:o,style:"square",color:[0,0,0,0],outline:{color:[255,127,0,1],width:1}})}case"simple-marker":{const{xoffset:e,yoffset:i,size:s,style:r}=t.symbol;return new k.default({xoffset:e,yoffset:i,style:"circle"===r?"circle":"square",size:s+2,color:[0,0,0,0],outline:{color:[255,127,0,1],width:1}})}case"simple-fill":return new O.default({color:[0,0,0,0],outline:{style:"dash",color:[255,127,0,1],width:1}});case"simple-line":return new V.default({color:[255,127,0,1],style:"dash",width:1});case"text":{const{xoffset:e,yoffset:i}=t.symbol;return new k.default({xoffset:e,yoffset:i,size:12,color:[0,0,0,0],outline:{color:[255,127,0,1],width:1}})}default:return null}}(0,s._)([(0,h.MZ)()],T.prototype,"_activeGraphic",void 0),(0,s._)([(0,h.MZ)({readOnly:!0})],T.prototype,"type",void 0),(0,s._)([(0,h.MZ)()],T.prototype,"callbacks",void 0),(0,s._)([(0,h.MZ)()],T.prototype,"enableMoveAllGraphics",void 0),(0,s._)([(0,h.MZ)()],T.prototype,"graphics",void 0),(0,s._)([(0,h.MZ)({value:!1})],T.prototype,"highlightsEnabled",null),(0,s._)([(0,h.MZ)()],T.prototype,"indicatorsEnabled",void 0),(0,s._)([(0,h.MZ)()],T.prototype,"layer",void 0),(0,s._)([(0,h.MZ)({readOnly:!0})],T.prototype,"state",null),(0,s._)([(0,h.MZ)()],T.prototype,"view",void 0),T=(0,s._)([(0,a.$)("esri.views.draw.support.GraphicMover")],T);const Z=T},67066:(t,e,i)=>{i.r(e),i.d(e,{default:()=>ct});var s=i(70273),r=(i(77844),i(42494)),o=i(71755),n=i(80757),h=i(55678),a=i(34429),l=i(11434),c=i(55748),p=i(73896),d=i(67519),v=(i(27052),i(11215),i(55292)),y=i(9440),u=i(26391),_=i(69806),g=i(40507),x=i(72299),m=i(92813),f=i(73218),w=i(8402),G=i(86586),M=i(82439),b=i(56538),k=i(3409),V=i(65433),O=i(93666),E=i(27196),T=i(68960),S=i(29025),Z=i(88617);let A=class extends Z.w{constructor(t){super(t),this.type="translate-vertex",this.distance=b.r7,this.elevation=null,this.area=null,this.totalLength=null}clear(){this.distance=b.r7,this.elevation=null,this.area=null,this.totalLength=null}};(0,s._)([(0,d.MZ)()],A.prototype,"type",void 0),(0,s._)([(0,d.MZ)()],A.prototype,"distance",void 0),(0,s._)([(0,d.MZ)()],A.prototype,"elevation",void 0),(0,s._)([(0,d.MZ)()],A.prototype,"area",void 0),(0,s._)([(0,d.MZ)()],A.prototype,"totalLength",void 0),A=(0,s._)([(0,v.$)("esri.views.interactive.tooltip.infos.TranslateVertexTooltipInfo")],A);var C=i(62593),I=i(30821),H=i(39130);function D(t,e){function i(){const t=e(),i=t.sketchOptions.tooltips.effectiveEnabled?t.activeTooltipInfo:null;return{...t,activeTooltipInfo:i}}let s=!1;function r(t){s||(s=!0,t(),s=!1)}return(0,M.vE)([(0,p.wB)((()=>{const t=i();return{context:t,geometry:t.graphic?.geometry,vertexGeometry:t.selectedVertex?.geometry}}),(e=>{let{context:i}=e;r((()=>{(function(t){const e=t.activeTooltipInfo;if(e){switch(e?.type){case"move-point":return function(t,e){let{graphic:i}=e;P(t,i,i?.geometry)}(e,t);case"selected-vertex":return function(t,e){let{graphic:i,selectedVertex:s}=e;P(t,i,s?.geometry);const r=i?.geometry;switch(r?.type){case"polygon":t.geometryType="polygon",t.totalLength.visible=!1,t.area.actual=(0,C.n)(r);break;case"polyline":t.geometryType="polyline",t.totalLength.actual=(0,I.ob)(r),t.area.visible=!1}}(e,t)}e.sketchOptions=t.sketchOptions}})(i),t.info=i.activeTooltipInfo}))}),p.pc),(0,p.wB)((()=>{const t=i(),{activeTooltipInfo:e}=t;if(e&&"key"in e)return{context:t,key:e.key}}),((t,e)=>{t&&e&&t.key!==e.key&&r((()=>R(t.context)))}),p.OH),(0,O.sZ)(t,{onBeforePaste:()=>{s=!0},onAfterPaste:()=>{R(i()),s=!1}})])}function P(t,e,i){e&&"point"===i?.type&&(t.setLocationFromPoint(i),t.elevation.actual=(0,H.Of)(i),t.elevation.visible=!!e.geometry?.hasZ,t.elevation.readOnly=!1,t.elevation.showAsZ=!0)}function R(t){function e(e,i){const s=i?.geometry;if(!s||"point"!==s.type)return;const{dx:r,dy:o,dz:n}=(0,O.mu)(e,s);if(0===r&&0===o&&0===n)return;const{x:h,y:a,z:l,m:c,spatialReference:p}=s,d=new V.A({x:h+r,y:a+o,z:null!=l?l+n:void 0,m:c,spatialReference:p});t.updateGeometry(i,d,s,r,o)}const{activeTooltipInfo:i,graphic:s,selectedVertex:r}=t;switch(i?.type){case"move-point":return e(i,s);case"selected-vertex":return e(i,r)}}function z(t,e,i){if(!i)return;const{x:s,y:r}=i.origin,o=e.toMap(i),n=e.toMap((0,k.tc)(s,r)),h=(0,I.Kt)(n,o);t.distance=null!=h?h:b.r7}var L=i(53825),U=i(24864),F=i(83476),B=i(26517),$=i(86007),K=i(16459),Y=i(87194),N=i(74795);class X{constructor(t,e,i){this.graphic=t,this.mover=e,this.selected=i,this.type="reshape-start"}}class q{constructor(t,e,i){this.graphic=t,this.mover=e,this.selected=i,this.type="reshape"}}class W{constructor(t,e,i){this.graphic=t,this.mover=e,this.selected=i,this.type="reshape-stop"}}class j{constructor(t,e,i){this.mover=t,this.dx=e,this.dy=i,this.type="move-start"}}class J{constructor(t,e,i){this.mover=t,this.dx=e,this.dy=i,this.type="move"}}class Q{constructor(t,e,i){this.mover=t,this.dx=e,this.dy=i,this.type="move-stop"}}class tt{constructor(t){this.added=t,this.type="vertex-select"}}class et{constructor(t){this.removed=t,this.type="vertex-deselect"}}class it{constructor(t,e,i,s){this.added=t,this.graphic=e,this.oldGraphic=i,this.vertices=s,this.type="vertex-add"}}class st{constructor(t,e,i,s){this.removed=t,this.graphic=e,this.oldGraphic=i,this.vertices=s,this.type="vertex-remove"}}const rt=L.W.reshapeGraphics,ot={vertices:{default:new _.default({style:"circle",size:rt.vertex.size,color:rt.vertex.color,outline:{color:rt.vertex.outlineColor,width:1}}),hover:new _.default({style:"circle",size:rt.vertex.hoverSize,color:rt.vertex.hoverColor,outline:{color:rt.vertex.hoverOutlineColor,width:1}}),selected:new _.default({style:"circle",size:rt.selected.size,color:rt.selected.color,outline:{color:rt.selected.outlineColor,width:1}})},midpoints:{default:new _.default({style:"circle",size:rt.midpoint.size,color:rt.midpoint.color,outline:{color:rt.midpoint.outlineColor,width:1}}),hover:new _.default({style:"circle",size:rt.midpoint.size,color:rt.midpoint.color,outline:{color:rt.midpoint.outlineColor,width:1}})}};let nt=class extends a.A.EventedAccessor{constructor(t){super(t),this._updateHandlesOnExternalGeometryChange=null,this._activeOperationInfo=null,this._editGeometryOperations=null,this._graphicAttributes={esriSketchTool:"box"},this._mover=null,this._snappingContext=null,this._snappingGraphicsLayer=null,this._hoverGraphic=null,this._snappingTask=null,this._stagedVertex=null,this.tooltip=null,this.activeTooltipInfo=null,this.callbacks={onReshapeStart(){},onReshape(){},onReshapeStop(){},onMoveStart(){},onMove(){},onMoveStop(){},onGraphicClick(){}},this.enableMidpoints=!0,this.enableMovement=!0,this.enableVertices=!0,this.graphic=null,this.layer=null,this.midpointGraphics=new n.A,this.midpointSymbol=new _.default({style:"circle",size:6,color:[200,200,200],outline:{color:[100,100,100],width:1}}),this.selectedVertices=new n.A,this.snappingManager=null,this.symbols=ot,this.sketchOptions=new K.A,this.type="reshape",this.vertexGraphics=new n.A,this.view=null}initialize(){const t=this.view;this._highlightHelper=new w.A({view:t}),this._setup(),this._updateHandlesOnExternalGeometryChange=(0,p.C1)((()=>this.graphic?.geometry),(t=>{if(!t)return;const e=new Set(this.selectedVertices.map((t=>t.attributes?.pointIndex)));this._highlightHelper.removeAll(),this._setUpHighlights(),this._setupGraphics(),this._clearSelection(),this.vertexGraphics.filter((t=>e.has(t.attributes.pointIndex))).forEach((t=>this._addToSelection(t)));const{enableMovement:i,_mover:s,graphic:r,midpointGraphics:o,vertexGraphics:n}=this,h=n.concat(o).items;i&&h.push(r),s?.set("graphics",h)}),p.OH),this.tooltip=(0,O.A)((()=>({view:t,options:this.sketchOptions.tooltips}))),this.tooltipInfos=function(t){const e={sketchOptions:t,viewType:"2d"};return{movePoint:new E.F(e),selectedVertex:new T.d(e),translateGraphic:new S.M(e),translateVertices:new A(e)}}(this.sketchOptions),this.addHandles([(0,p.z7)((()=>t?.ready),(()=>{const{layer:t,view:e}=this;(0,G.Y)(e,t),this.addHandles(e.on("key-down",(t=>this._keyDownHandler(t)),U.o.TOOL))}),{once:!0,initial:!0}),(0,p.wB)((()=>this.graphic),(()=>this.refresh())),(0,p.wB)((()=>this.layer),((t,e)=>{e&&(this._clearSelection(),this._resetGraphics(e)),this.refresh()})),(0,p.wB)((()=>this.enableMidpoints),(()=>this.refresh())),D(this.tooltip,(()=>this._tooltipsContext)),(0,p.wB)((()=>this.view.effectiveTheme.accentColor),(()=>this._updateSymbolsForTheme()),p.Vh),this._updateHandlesOnExternalGeometryChange]),this._updateTooltip()}destroy(){this._reset(),this._mover?.destroy(),this._mover=null,this.tooltip=(0,c.pR)(this.tooltip)}get _coordinateHelper(){return this._editGeometryOperations?.data.coordinateHelper??(0,F.BV)(!!this.graphic.geometry?.hasZ,!!this.graphic.geometry?.hasM,this.view.spatialReference)}get _selectedVertex(){return 1===this.selectedVertices.length?this.selectedVertices.at(0):void 0}get _tooltipsContext(){return{sketchOptions:this.sketchOptions,activeTooltipInfo:this.activeTooltipInfo,graphic:this.graphic,selectedVertex:this._selectedVertex,updateGeometry:(t,e,i,s,r)=>{this._setUpGeometryHelper();const o=t===this.graphic;o?this._emitMoveStartEvent(0,0):this._emitReshapeStartEvent(t);if(this._syncGeometryAfterVertexMove(t,e,s,r,!0),o){const{view:t}=this,s=t.toScreen(i),r=t.toScreen(e),o=(r?.x??0)-(s?.x??0),n=(r?.y??0)-(s?.y??0);this._emitMoveEvent(o,n),this._emitMoveStopEvent(o,n)}else this._emitReshapeEvent(t),this._emitReshapeStopEvent(t);this._editGeometryOperations=(0,c.pR)(this._editGeometryOperations)}}}set highlightsEnabled(t){this._highlightHelper?.removeAll(),this._set("highlightsEnabled",t),this._setUpHighlights()}get state(){const t=this.view.ready,e=!(!this.graphic||!this.layer);return t&&e?"active":t?"ready":"disabled"}isUIGraphic(t){const e=[];return this.graphic&&e.push(this.graphic),e.concat(this.vertexGraphics.items,this.midpointGraphics.items),e.length>0&&e.includes(t)}refresh(){this._reset(),this._setup()}reset(){this.graphic=null}clearSelection(){this._clearSelection()}removeSelectedVertices(){const{selectedVertices:t}=this;t.length&&this._removeVertices(t)}_setup(){const{graphic:t,layer:e}=this;if(!e||null==t?.geometry)return;const i=t.geometry;"mesh"!==i.type&&"extent"!==i.type?("polygon"===i.type&&(0,y.uC)(i),this._setUpHighlights(),this._setupGraphics(),this._setupMover()):this._logGeometryTypeError()}_setUpHighlights(){this.highlightsEnabled&&this.graphic&&this._highlightHelper?.add(this.graphic)}_setUpGeometryHelper(){const t=this.graphic.geometry;if(null==t||"mesh"===t.type||"extent"===t.type)return void this._logGeometryTypeError();const e="multipoint"===t.type?new N.A({paths:[t.points],spatialReference:t.spatialReference}):t;this._editGeometryOperations=$.p.fromGeometry(e,g.RT.Local)}_saveSnappingContextForHandle(t,e){this._snappingGraphicsLayer=new u.A({listMode:"hide",internal:!0,title:"Reshape snapping layer"}),this.view.map.layers.add(this._snappingGraphicsLayer);const i=this._editGeometryOperations;(0,c.Lw)(i),this._snappingContext=new Y.e({editGeometryOperations:i,elevationInfo:{mode:"on-the-ground",offset:0},pointer:e.viewEvent?.pointerType||"mouse",excludeFeature:this.graphic,feature:this.graphic,visualizer:new x.J(this._snappingGraphicsLayer),vertexHandle:this._getVertexFromEditGeometry(t)})}_reset(){this._clearSelection(),this._highlightHelper?.removeAll(),this._updateTooltip(),this._resetGraphics(),this._resetSnappingStateVars(),this._activeOperationInfo=null,this._mover&&this._mover.destroy(),this._mover=null,this.view.cursor="default"}_resetSnappingStateVars(){null!=this.snappingManager&&this.snappingManager.doneSnapping(),null!=this._snappingGraphicsLayer&&(this.view?.map&&this.view.map.layers.remove(this._snappingGraphicsLayer),this._snappingGraphicsLayer.destroy()),this._editGeometryOperations=(0,c.pR)(this._editGeometryOperations),this._snappingTask=(0,c.DC)(this._snappingTask),this._snappingTask=null,this._snappingContext=null,this._stagedVertex=null}_resetGraphics(t){this._removeMidpointGraphics(t),this._removeVertexGraphics(t),this.selectedVertices.removeAll(),this._updateTooltip()}_removeMidpointGraphics(t){const e=t||this.layer;e&&e.removeMany(this.midpointGraphics.items),this.midpointGraphics.items.forEach((t=>t.destroy())),this.midpointGraphics.removeAll()}_removeVertexGraphics(t){const e=t||this.layer;e&&e.removeMany(this.vertexGraphics.items),this.vertexGraphics.items.forEach((t=>t.destroy())),this.vertexGraphics.removeAll()}_setupGraphics(){const t=this.graphic.geometry;if(null!=t&&("polyline"===t.type||"polygon"===t.type)){const e=ht(t);this.enableMidpoints&&this._setUpMidpointGraphics(e),this.enableVertices&&this._setUpVertexGraphics(e)}}_setUpMidpointGraphics(t){this._removeMidpointGraphics();const e=this._createMidpointGraphics(t);this.midpointGraphics.addMany(e),this.layer.addMany(e)}_setUpVertexGraphics(t){this._removeVertexGraphics();const e=this._createVertexGraphics(t);this.vertexGraphics.addMany(e),this._storeRelatedVertexIndices(),this.layer.addMany(e)}_createVertexGraphics(t){const{_graphicAttributes:e,symbols:i}=this,s=[];return t?.forEach(((t,o)=>{t.forEach(((t,n)=>{s.push(new r.A({geometry:this._coordinateHelper.arrayToPoint(t),symbol:i?.vertices?.default,attributes:{...e,pathIndex:o,pointIndex:n}}))}))})),s}_createMidpointGraphics(t){const{_graphicAttributes:e,symbols:i}=this,s=[];for(let o=0;o<t.length;o++){const n=t[o];for(let t=0;t<n.length;t++){const h=(t+1)%n.length;if("polyline"===this.graphic.geometry?.type&&0===h)continue;const a=n[t],l=n[h],c=this._getMidpoint(a,l);s.push(new r.A({geometry:c,symbol:i.midpoints.default,attributes:{...e,pathIndex:o,pointIndexStart:t,pointIndexEnd:h}}))}}return s}_updateSymbolsForTheme(){const t=this.view.effectiveTheme.accentColor;this.symbols={vertices:{...this.symbols.vertices,default:this.symbols.vertices.default.clone().set("color",t),hover:this.symbols.vertices.hover?.clone().set("color",t)},midpoints:{...this.symbols.midpoints}};for(const e of this.vertexGraphics)this._isSelected(e)?e.symbol=this.symbols.vertices.selected:this._hoverGraphic===e?e.symbol=this.symbols.vertices.hover:e.symbol=this.symbols.vertices.default}_storeRelatedVertexIndices(){const t=this.vertexGraphics.items;if(!t)return;const e=t.map((t=>{let{geometry:e}=t;return{x:e.x,y:e.y}}));for(let i=0;i<e.length;i++){const s=[];for(let t=0;t<e.length;t++){if(i===t)continue;const r=e[i],o=e[t];r.x===o.x&&r.y===o.y&&s.push(t)}t[i].attributes.relatedGraphicIndices=s}}_setupMover(){const{enableMovement:t,graphic:e,midpointGraphics:i,vertexGraphics:s,view:r}=this,o=s.concat(i).items;t&&o.push(e),this._mover=new f.default({enableMoveAllGraphics:!1,highlightsEnabled:!1,indicatorsEnabled:!1,graphics:o,view:r,callbacks:{onGraphicClick:t=>this._onGraphicClickCallback(t),onGraphicMoveStart:t=>this._onGraphicMoveStartCallback(t),onGraphicMove:t=>this._onGraphicMoveCallback(t),onGraphicMoveStop:t=>this._onGraphicMoveStopCallback(t),onGraphicPointerOver:t=>this._onGraphicPointerOverCallback(t),onGraphicPointerOut:t=>this._onGraphicPointerOutCallback(t)}})}_onGraphicClickCallback(t){t.viewEvent.stopPropagation();const e=t.graphic;if(e===this.graphic)this.clearSelection(),this.emit("graphic-click",t),this.callbacks.onGraphicClick?.(t);else if(this._isMidpoint(e)){if(2===t.viewEvent.button)return;const i=this.graphic.clone(),s=this._createVertexFromMidpoint(e);this.refresh(),this._emitVertexAddEvent([e],i,s)}else this._isVertex(e)&&(t.viewEvent.stopPropagation(),2===t.viewEvent.button?this._removeVertices(e):(t.viewEvent.native.shiftKey||this._clearSelection(),this.selectedVertices.includes(e)?this._removeFromSelection(e,!0):this._addToSelection(e)))}_setUpOperation(t){const{graphic:e,dx:i,dy:s}=t,r=e===this.graphic;this._resetSnappingStateVars(),this._setUpGeometryHelper(),this._saveSnappingContextForHandle(e,t),this._activeOperationInfo={target:this.graphic,mover:e,operationType:r?"move":"reshape",totalDx:i,totalDy:s}}_onGraphicMoveStartCallback(t){const{dx:e,dy:i,graphic:s}=t;if(s===this.graphic){const{geometry:r}=s;return this._setUpOperation(t),this._emitMoveStartEvent(e,i),void(null!=r&&"point"===r.type&&this._onHandleMove(s,e,i,t,(()=>{this._updateTooltip(this.graphic,t.viewEvent),this._emitMoveEvent(e,i)})))}if(!this.selectedVertices.includes(s)){if(this._clearSelection(),this._isMidpoint(s)){const t=this.graphic.clone(),e=this._createVertexFromMidpoint(s);this._emitVertexAddEvent([s],t,e)}this._addToSelection(s)}this._setUpOperation(t),this._emitReshapeStartEvent(s),this._onHandleMove(s,e,i,t,(()=>{this._updateTooltip(s,t.viewEvent),this._emitReshapeEvent(s)}))}_onGraphicMoveCallback(t){const e=this._activeOperationInfo;if(!e)return;const{dx:i,dy:s,graphic:r}=t;e.totalDx+=i,e.totalDy+=s;const{operationType:o}=e,{geometry:n}=r;if(null!=n)if("move"!==o)this._onHandleMove(r,i,s,t,(()=>{this._updateTooltip(r,t.viewEvent),this._emitReshapeEvent(r)}));else if("point"===n.type)this._onHandleMove(r,i,s,t,(()=>{this._updateTooltip(this.graphic,t.viewEvent),this._emitMoveEvent(i,s)}));else if("polyline"===n.type||"polygon"===n.type){const e=ht(n);this._updateVertexGraphicLocations(e),this._updateTooltip(this.graphic,t.viewEvent),this._emitMoveEvent(i,s)}}_onGraphicMoveStopCallback(t){const e=this._activeOperationInfo;if(!e)return;const{dx:i,dy:s,graphic:r}=t,{operationType:o}=e;e.totalDx+=i,e.totalDy+=s,this._onHandleMove(r,i,s,t,(()=>"move"===o?this._emitMoveStopEvent():this._emitReshapeStopEvent(r))),this._isMidpoint(r)?this.refresh():(this._updateTooltip(this._isVertex(r)?r:null),this._resetSnappingStateVars(),this._activeOperationInfo=null)}_updateVertexGraphicLocations(t){const{_coordinateHelper:e}=this;for(const i of this.vertexGraphics){const{pathIndex:s,pointIndex:r}=i.attributes;i.geometry=e.arrayToPoint(t[s][r])}this._updateMidpointGraphicLocations(t)}_updateMidpointGraphicLocations(t){for(const e of this.midpointGraphics){const{pathIndex:i,pointIndexStart:s,pointIndexEnd:r}=e.attributes,o=t[i];e.geometry=this._getMidpoint(o[s],o[r])}}_getMidpoint(t,e){const{_coordinateHelper:i}=this,s=i.arrayToVector(t),r=i.arrayToVector(e),o=i.toXYZ(s),n=i.toXYZ(r),[h,a,l]=(0,y.t9)(o,n),c=i.hasM()?0:void 0;return new V.A({x:h,y:a,z:l,m:c,spatialReference:i.spatialReference})}_getVertexFromEditGeometry(t){const[e,i]=at(t);return(0,c.Lw)(this._editGeometryOperations),this._editGeometryOperations.data.components[e].vertices[i]}_onHandleMove(t,e,i,s,r){(0,c.DC)(this._snappingTask);const n=this._snappingContext;if(!n)return;const h=t.geometry,a="graphic-move-stop"===s.type;if(null!=this.snappingManager&&this.selectedVertices.length<2&&!a){const s=this.snappingManager;this._stagedVertex=s.update({point:h,context:n}),this._syncGeometryAfterVertexMove(t,new V.A(this._stagedVertex),e,i,a),r(),this._snappingTask=(0,o.UT)((async o=>{const l=await s.snap({point:h,context:n,signal:o});l.valid&&(this._stagedVertex=l.apply(),this._syncGeometryAfterVertexMove(t,new V.A(this._stagedVertex),e,i,a),r())}))}else{const s=null!=this._stagedVertex?new V.A(this._stagedVertex):h;this._syncGeometryAfterVertexMove(t,s,e,i,a),r()}}_syncGeometryAfterVertexMove(t,e,i,s){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const o=this._editGeometryOperations?.data.geometry;if(o)if("point"===o.type)t.geometry=e;else if("mesh"===o.type)t.geometry=o.centerAt(e);else{const{_coordinateHelper:n}=this,[h,a]=at(t);let l=(0,y.$K)(o);const c=l[h].length-1,p=n.pointToArray(e);l[h][a]=p,"polygon"===o.type&&(0===a?l[h][c]=p:a===c&&(l[h][0]=p)),this._isVertex(t)&&(l=this._moveRelatedCoordinates(l,t,p),l=this._moveSelectedHandleCoordinates(l,t,i,s,"polygon"===o.type),this._updateMidpointGraphicLocations(l)),this._updateGraphicGeometry(o.clone());const d=n.pointToVector(e),v=this._getVertexFromEditGeometry(t),u=n.getZ(d),_=d[0]-v.pos[0],g=d[1]-v.pos[1],x=null!=u?u-v.pos[2]:0;this._editGeometryOperations?.moveVertices([v],_,g,x),r&&(this._mover?this._mover.updateGeometry(this._mover.graphics.indexOf(t),e):t.geometry=e)}}_moveRelatedCoordinates(t,e,i){const{relatedGraphicIndices:s}=e.attributes;for(const r of s){const s=this.vertexGraphics.at(r),{pathIndex:o,pointIndex:n}=s.attributes;t[o][n]=i,s.geometry=e.geometry}return t}_moveSelectedHandleCoordinates(t,e,i,s,r){for(const o of this.selectedVertices)if(o!==e){const{pathIndex:e,pointIndex:n,relatedGraphicIndices:h}=o.attributes,a=(0,m.lR)(o.geometry,i,s,this.view),l=(0,y.$K)(a),c=t[e].length-1;t[e][n]=l,o.geometry=a,r&&(0===n?t[e][c]=l:n===c&&(t[e][0]=l));for(const i of h){const e=this.vertexGraphics.at(i),{pathIndex:s,pointIndex:r}=e.attributes;t[s][r]=l,e.geometry=a}}return t}_onGraphicPointerOverCallback(t){const e=t.graphic;this._hoverGraphic=e;const i=this._isVertex(e);i&&!this._isSelected(e)&&(e.symbol=this.symbols.vertices.hover),this._updateTooltip(i?e:null),this._updateHoverCursor(e)}_onGraphicPointerOutCallback(t){const e=t.graphic;this._hoverGraphic=null,this._isVertex(e)&&!this._isSelected(e)&&(e.symbol=this.symbols.vertices.default),this.view.cursor="default",this._updateTooltip()}_createVertexFromMidpoint(t){const{_graphicAttributes:e,graphic:i}=this,s=i.geometry;if(null==s||"polygon"!==s.type&&"polyline"!==s.type)return[];const r=s.clone(),o=[],{pathIndex:n,pointIndexStart:h,pointIndexEnd:a}=t.attributes,l=(0,y.$K)(t.geometry),c=0===a?h+1:a,p=(0,y.$K)(r);return p[n].splice(c,0,l),t.attributes={...e,pathIndex:n,pointIndex:c,relatedGraphicIndices:[]},o.push({coordinates:p[n][c],componentIndex:n,vertexIndex:c}),this._updateGraphicGeometry(r),o}_addToSelection(t){const e=lt(t);for(const i of e)i.symbol=this.symbols.vertices.selected,this.selectedVertices.add(i),this._updateTooltip(i);this._emitSelectEvent(e)}_removeFromSelection(t,e){const{vertices:i}=this.symbols,s=e?i.hover:i.default;this.selectedVertices.remove(t),t.symbol=s,this._emitDeselectEvent([t]),this._updateTooltip()}_clearSelection(){const t=this.selectedVertices.toArray();if(t.length>0){for(const e of t)e.set("symbol",this.symbols.vertices.default);this.selectedVertices.removeAll(),this._emitDeselectEvent(t),this._updateTooltip()}}_keyDownHandler(t){null==this._activeOperationInfo&&(0,O.wG)(t,this.tooltip)||B.NE.delete.includes(t.key)&&!t.repeat&&this.selectedVertices.length&&this._removeVertices(this.selectedVertices)}_removeVertices(t){const e=this.graphic.geometry;if(null==e||"polygon"!==e.type&&"polyline"!==e.type)return;if("polygon"===e.type&&this.vertexGraphics.length<4||this.vertexGraphics.length<3)return;const i=this.graphic.clone(),s=e.clone();let r=(0,y.$K)(s);const o=[],n=lt(t);for(const h of n){const{x:t,y:e}=h.geometry;for(let i=0;i<r.length;i++){const s=r[i];for(let n=0;n<s.length;n++){const[h,a]=s[n];t===h&&e===a&&(o.push({coordinates:r[i][n],componentIndex:i,vertexIndex:n}),r[i].splice(Number(n),1))}}}if("polygon"===s.type)r=r.filter((t=>{if(t.length<2)return!1;const[e,i]=t[0],[s,r]=t[t.length-1];return(2!==t.length||e!==s||i!==r)&&(e===s&&i===r||t.push(t[0]),!0)})),s.rings=r;else{for(const t of r)1===t.length&&r.splice(r.indexOf(t),1);s.paths=r}this._updateGraphicGeometry(s),this.refresh(),this._emitVertexRemoveEvent(n,i,o)}_isVertex(t){return this.vertexGraphics.includes(t)}_isSelected(t){return this._isVertex(t)&&this.selectedVertices.includes(t)}_isMidpoint(t){return this.midpointGraphics.includes(t)}_updateHoverCursor(t){this.view.cursor=this._isMidpoint(t)?"copy":"move"}_updateTooltip(t,e){let i=null;const{graphic:s,view:r,tooltipInfos:o}=this,n=s?.geometry;"point"===n?.type?i=o.movePoint:this._selectedVertex?i=o.selectedVertex:t===this.graphic?(i=o.translateGraphic,function(t,e,i){t.clear(),z(t,e,i)}(i,r,e)):t&&this.selectedVertices.length>1&&(i=o.translateVertices,function(t,e,i,s){t.clear(),"polygon"===i?.type?t.area=(0,C.n)(i):"polyline"===i?.type&&(t.totalLength=(0,I.ob)(i)),z(t,e,s)}(i,r,n,e)),this.activeTooltipInfo=i}_updateGraphicGeometry(t){this._updateHandlesOnExternalGeometryChange?.pause(),this.graphic.geometry=t,this._updateHandlesOnExternalGeometryChange?.resume()}_emitMoveStartEvent(t,e){const i=new j(this.graphic,t,e);this.emit("move-start",i),this.callbacks.onMoveStart?.(i)}_emitMoveEvent(t,e){const i=new J(this.graphic,t,e);this.emit("move",i),this.callbacks.onMove?.(i)}_emitMoveStopEvent(t,e){if(null==t||null==e){const i=this._activeOperationInfo;if(!i)return;t=i.totalDx,e=i.totalDy}const i=new Q(this.graphic,t,e);this.emit("move-stop",i),this.callbacks.onMoveStop?.(i)}_emitReshapeStartEvent(t){const e=new X(this.graphic,t,this.selectedVertices.toArray());this.emit("reshape-start",e),this.callbacks.onReshapeStart?.(e)}_emitReshapeEvent(t){const e=new q(this.graphic,t,this.selectedVertices.toArray());this.emit("reshape",e),this.callbacks.onReshape?.(e)}_emitReshapeStopEvent(t){const e=new W(this.graphic,t,this.selectedVertices.toArray());this.emit("reshape-stop",e),this.callbacks.onReshapeStop?.(e)}_emitSelectEvent(t){const e=new tt(t);this.emit("select",e),this.callbacks.onVertexSelect?.(e)}_emitDeselectEvent(t){const e=new et(t);this.emit("deselect",e),this.callbacks.onVertexDeselect?.(e)}_emitVertexAddEvent(t,e,i){const s=new it(t,this.graphic,e,i);this.emit("vertex-add",s),this.callbacks.onVertexAdd?.(s)}_emitVertexRemoveEvent(t,e,i){const s=new st(t,this.graphic,e,i);this.emit("vertex-remove",s),this.callbacks.onVertexRemove?.(s)}_logGeometryTypeError(){l.A.getLogger(this).error(new h.A("reshape:invalid-geometry","Reshape operation not supported for the provided graphic. The geometry type is not supported."))}};function ht(t){const e=(0,y.$K)(t.clone());if("polygon"===t.type)for(const i of e){const t=i[i.length-1];i[0][0]===t[0]&&i[0][1]===t[1]&&i.length>2&&i.pop()}return e}function at(t){let{attributes:e}=t;return[e?.pathIndex||0,e?.pointIndex||0]}function lt(t){return t instanceof r.A?[t]:[...t]}(0,s._)([(0,d.MZ)()],nt.prototype,"_activeOperationInfo",void 0),(0,s._)([(0,d.MZ)()],nt.prototype,"_coordinateHelper",null),(0,s._)([(0,d.MZ)()],nt.prototype,"_editGeometryOperations",void 0),(0,s._)([(0,d.MZ)()],nt.prototype,"tooltip",void 0),(0,s._)([(0,d.MZ)()],nt.prototype,"tooltipInfos",void 0),(0,s._)([(0,d.MZ)()],nt.prototype,"activeTooltipInfo",void 0),(0,s._)([(0,d.MZ)()],nt.prototype,"_selectedVertex",null),(0,s._)([(0,d.MZ)()],nt.prototype,"_tooltipsContext",null),(0,s._)([(0,d.MZ)()],nt.prototype,"callbacks",void 0),(0,s._)([(0,d.MZ)()],nt.prototype,"enableMidpoints",void 0),(0,s._)([(0,d.MZ)()],nt.prototype,"enableMovement",void 0),(0,s._)([(0,d.MZ)()],nt.prototype,"enableVertices",void 0),(0,s._)([(0,d.MZ)()],nt.prototype,"graphic",void 0),(0,s._)([(0,d.MZ)({value:!0})],nt.prototype,"highlightsEnabled",null),(0,s._)([(0,d.MZ)()],nt.prototype,"layer",void 0),(0,s._)([(0,d.MZ)({readOnly:!0})],nt.prototype,"midpointGraphics",void 0),(0,s._)([(0,d.MZ)()],nt.prototype,"midpointSymbol",void 0),(0,s._)([(0,d.MZ)({readOnly:!0})],nt.prototype,"selectedVertices",void 0),(0,s._)([(0,d.MZ)()],nt.prototype,"snappingManager",void 0),(0,s._)([(0,d.MZ)({readOnly:!0})],nt.prototype,"state",null),(0,s._)([(0,d.MZ)()],nt.prototype,"symbols",void 0),(0,s._)([(0,d.MZ)({type:K.A})],nt.prototype,"sketchOptions",void 0),(0,s._)([(0,d.MZ)({readOnly:!0})],nt.prototype,"type",void 0),(0,s._)([(0,d.MZ)({readOnly:!0})],nt.prototype,"vertexGraphics",void 0),(0,s._)([(0,d.MZ)()],nt.prototype,"view",void 0),nt=(0,s._)([(0,v.$)("esri.views.draw.support.Reshape")],nt);const ct=nt},53825:(t,e,i)=>{i.d(e,{W:()=>p});var s=i(36329);const r={main:new s.A([255,127,0]),selected:new s.A([255,255,255]),outline:new s.A([0,0,0,.5]),selectedOutline:new s.A([255,255,255]),hoverOutline:new s.A([255,255,255]),secondary:new s.A([255,255,255]),secondaryOutline:new s.A([100,100,100]),transparent:new s.A([0,0,0,0])};function o(t,e){Object.assign(t,e)}class n{constructor(t){this.size=8,this.hoverSize=10,this.color=r.main,this.hoverColor=r.main,this.outlineColor=r.outline,this.hoverOutlineColor=r.hoverOutline,o(this,t)}}class h{constructor(t){this.color=r.secondary,this.hoverColor=r.main,o(this,t)}}class a{constructor(t){this.color=r.transparent,this.hoverColor=r.transparent,this.outlineColor=r.main,this.hoverOutlineColor=r.main,this.stagedColor=r.transparent,this.stagedOutlineColor=r.secondary,o(this,t)}}class l{constructor(t){this.vertex=new n,this.midpoint=new n({color:r.secondary,outlineColor:r.secondaryOutline,size:6}),this.selected=new n({color:r.selected,hoverColor:r.selected,hoverOutlineColor:r.hoverOutline}),o(this,t)}}class c{constructor(t){this.center=new n({color:r.secondaryOutline}),this.fill=new a,this.line=new h,this.vertex=new n({color:r.selected,outlineColor:r.main,hoverColor:r.selected,hoverOutlineColor:r.secondaryOutline}),o(this,t)}}const p=new class{constructor(t){this.reshapeGraphics=new l,this.transformGraphics=new c,o(this,t)}}},27196:(t,e,i)=>{i.d(e,{F:()=>a});var s=i(70273),r=i(67519),o=(i(27052),i(11434),i(11215),i(55292)),n=i(88617),h=i(4702);let a=class extends((0,h.B)(n.w)){constructor(t){super(t),this.type="move-point",this.allFields.forEach((t=>{t.lockable=!1,t.setActual(null)}))}get allFields(){return[this.longitude,this.latitude,this.x,this.y,this.elevation]}};(0,s._)([(0,r.MZ)()],a.prototype,"allFields",null),a=(0,s._)([(0,o.$)("esri.views.interactive.tooltip.infos.MovePointTooltipInfo")],a)},68960:(t,e,i)=>{i.d(e,{d:()=>l});var s=i(70273),r=i(67519),o=(i(27052),i(11434),i(11215),i(55292)),n=i(8545),h=i(88617),a=i(4702);let l=class extends((0,a.B)(h.w)){constructor(t){super(t),this.type="selected-vertex",this.area=(0,n.Am)(),this.totalLength=(0,n.fr)(),this.geometryType="polyline",this.allFields.forEach((t=>{t.lockable=!1,t.setActual(null)}))}get allFields(){return[this.longitude,this.latitude,this.x,this.y,this.elevation,"polygon"===this.geometryType?this.area:this.totalLength]}};(0,s._)([(0,r.MZ)()],l.prototype,"geometryType",void 0),(0,s._)([(0,r.MZ)()],l.prototype,"allFields",null),l=(0,s._)([(0,o.$)("esri.views.interactive.tooltip.infos.SelectedVertexTooltipInfo")],l)},29025:(t,e,i)=>{i.d(e,{M:()=>a});var s=i(70273),r=i(56538),o=i(67519),n=(i(27052),i(11434),i(11215),i(55292)),h=i(88617);let a=class extends h.w{constructor(t){super(t),this.type="translate",this.distance=r.r7}clear(){this.distance=r.r7}};(0,s._)([(0,o.MZ)()],a.prototype,"type",void 0),(0,s._)([(0,o.MZ)()],a.prototype,"distance",void 0),a=(0,s._)([(0,n.$)("esri.views.interactive.tooltip.infos.TranslateTooltipInfo")],a)}}]);
//# sourceMappingURL=1290.582d7018.chunk.js.map