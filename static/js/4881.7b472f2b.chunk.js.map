{"version":3,"file":"static/js/4881.7b472f2b.chunk.js","mappings":"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","sources":["../node_modules/@arcgis/core/layers/graphics/sources/support/uploadProgressWeights.js","../node_modules/@arcgis/core/support/progressUtils.js","../node_modules/@arcgis/core/widgets/Editor/Upload.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nconst e={upload:{createFromFiles:.8,loadMesh:.2},uploadAssetBlobs:{prepareAssetItems:.9,uploadAssetItems:.1},uploadConvertibleSource:{uploadEditSource:.5,serviceAssetsToGlb:.5},uploadLocalMesh:{meshToAssetBlob:.5,uploadAssetBlobs:.5}};export{e as uploadProgressWeights};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{makeHandle as s}from\"../core/handleUtils.js\";import has from\"../core/has.js\";import{getOrCreateMapValue as t}from\"../core/MapUtils.js\";import{millisecondsFromSeconds as e,Seconds as r,Milliseconds as o}from\"../core/time.js\";function i(s,t=s=>{},e){return new n(s,t,e)}class n{constructor(s,t=s=>{},e){if(this.onProgress=t,this.taskName=e,this._progressMap=new Map,this._startTime=void 0,this._timingsMap=new Map,\"number\"==typeof s){this._weights={};for(let t=0;t<s;t++){const e=t,r=1/s;this._weights[e]=r,this._progressMap.set(e,0)}}else this._weights=s;this.emitProgress()}emitProgress(){let s=0;for(const[t,e]of this._progressMap.entries()){s+=e*this._weights[t]}if(1===s&&has(\"enable-feature:esri-3dofl-upload-timings\")){const s=Math.round(performance.now()-(this._startTime??0))/1e3;console.log(`${this.taskName} done in ${s} sec`);for(const[t,e]of this._timingsMap){const r=Math.round(e.end-e.start)/1e3,o=Math.round(r/s*100);console.log(this.taskName??\"Task\",{stepKey:t,stepTime:r,relativeTime:o})}}this.onProgress(s)}setProgress(s,e){if(this._progressMap.set(s,e),has(\"enable-feature:esri-3dofl-upload-timings\")){const r=performance.now();this._startTime??=r;const o=t(this._timingsMap,s,(()=>({start:r,end:0})));1===e&&(o.end=r)}this.emitProgress()}simulate(s,t){return a((t=>this.setProgress(s,t)),t)}makeOnProgress(s){return t=>this.setProgress(s,t)}}function a(t=s=>{},e=l){const r=performance.now();t(0);const o=setInterval((()=>{const s=performance.now()-r,o=1-Math.exp(-s/e);t(o)}),g);return s((()=>{clearInterval(o),t(1)}))}function h(s,t=c){return e(r(s*f/t))}function m(s,t=p){return e(r(s*f/t))}const c=10,p=10,f=8e-6,g=o(50),l=o(1e3);export{n as ProgressManager,m as estimatedConversionTime,h as estimatedTransferTime,i as makeProgressManager,a as simulateProgress};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import r from\"../../core/Accessor.js\";import{createTask as t}from\"../../core/asyncUtils.js\";import o from\"../../core/Error.js\";import{on as s}from\"../../core/events.js\";import has from\"../../core/has.js\";import{throwIfAborted as i,createResolver as a}from\"../../core/promiseUtils.js\";import{property as l}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/Logger.js\";import\"../../core/RandomLCG.js\";import{subclass as n}from\"../../core/accessorSupport/decorators/subclass.js\";import p from\"../../geometry/Point.js\";import{initializeProjection as c,project as u}from\"../../geometry/projection.js\";import{equalsWithProjectionEngine as f}from\"../../geometry/support/spatialReferenceUtils.js\";import{uploadProgressWeights as m}from\"../../layers/graphics/sources/support/uploadProgressWeights.js\";import{getSupportedExtensions as d}from\"../../layers/support/infoFor3D.js\";import{makeProgressManager as h,estimatedTransferTime as y}from\"../../support/progressUtils.js\";let g=class extends r{constructor(){super({}),this.files=[],this.progress=0,this._uploadTask=null,this._layer=null}destroy(){this.cancel(),this.files=[],this._layer=null,this._uploadTask=null}get state(){const e=this._uploadTask;return e&&0!==this.files.length?e.finished?e.error?\"error\":\"success\":\"pending\":\"default\"}get result(){return this._uploadTask?.value??null}get error(){return this._uploadTask?.error??null}uploadTo(e){this.cancel(),this.files=[],this._layer=e,this._uploadTask=t((async r=>{const t=await v(e);i(r),this.progress=0,this.files=t;const s=h(m.upload,(e=>{this.progress=e}),\"Upload.uploadTo\");if(0===t.length)return null;i(r);const a=await e.extractAndFilterFiles(t);i(r),a.length>0&&(this.files=a);const l=await e.convertMesh(a,{signal:r,onProgress:s.makeOnProgress(\"createFromFiles\")});if(i(r),!l)throw new o(\"editor:upload\",\"could not upload or convert model\");const n=a.reduce(((e,r)=>e+r.size),0),p=s.simulate(\"loadMesh\",y(n));try{await l.load()}finally{p.remove()}if(has(\"enable-feature:georeferenced-uploads\")&&l.metadata.georeferenced){if(await f(e.spatialReference,l.origin?.spatialReference))return{type:\"georeferenced\",mesh:l};if((e.spatialReference.isWebMercator||e.spatialReference.isWGS84)&&await R(l,e.spatialReference))return{type:\"georeferenced-reprojected\",mesh:l}}return l.spatialReference=e.spatialReference,l.vertexSpace.origin=[0,0,0],{type:\"non-georeferenced\",mesh:l}}))}retry(){this._layer&&this.uploadTo(this._layer)}cancel(){this._uploadTask?.abort()}};e([l()],g.prototype,\"files\",void 0),e([l()],g.prototype,\"progress\",void 0),e([l()],g.prototype,\"state\",null),e([l()],g.prototype,\"result\",null),e([l()],g.prototype,\"error\",null),e([l()],g.prototype,\"_uploadTask\",void 0),e([l()],g.prototype,\"_layer\",void 0),g=e([n(\"esri.widgets.Editor.Upload\")],g);let j=null;async function v(e){const{resolve:r,promise:t}=a(),o=document.createElement(\"input\");o.type=\"file\",o.multiple=!1,o.accept=[...d(e.infoFor3D),\".zip\"].join(\",\"),o.style.display=\"none\",document.body.appendChild(o);const i=s(o,\"change\",(()=>r(o.files?Array.from(o.files):[])));return j?j(o):o.click(),t.finally((()=>{i.remove(),o.remove()}))}function _(e,r){j=t=>{r?.(),Promise.resolve().then((()=>e)).then((e=>{if(!j)return;const r=new DataTransfer;e.forEach((e=>r.items.add(e))),t.files=r.files,t.dispatchEvent(new Event(\"change\"))}))}}function w(){j=null}async function R(e,r){if(await c(e.spatialReference,r),!e.vertexSpace.origin)return!1;const[t,o,s]=e.vertexSpace.origin,i=new p({x:t,y:o,z:s,spatialReference:e.spatialReference}),a=u(i,r);return!!a&&(e.vertexSpace.origin=[a.x,a.y,a.z??0],e.spatialReference=r,!0)}export{g as Upload,w as clearPromptForFilesStub,_ as stubFilePickerToSelect};\n"],"names":["e","upload","createFromFiles","loadMesh","uploadAssetBlobs","prepareAssetItems","uploadAssetItems","uploadConvertibleSource","uploadEditSource","serviceAssetsToGlb","uploadLocalMesh","meshToAssetBlob","i","s","n","arguments","length","undefined","constructor","t","this","onProgress","taskName","_progressMap","Map","_startTime","_timingsMap","_weights","r","set","emitProgress","entries","has","Math","round","performance","now","console","log","end","start","o","stepKey","stepTime","relativeTime","setProgress","simulate","a","makeOnProgress","l","setInterval","exp","g","clearInterval","h","c","f","m","p","super","files","progress","_uploadTask","_layer","destroy","cancel","state","finished","error","result","value","uploadTo","async","resolve","promise","document","createElement","type","multiple","accept","d","infoFor3D","join","style","display","body","appendChild","Array","from","j","click","finally","remove","v","extractAndFilterFiles","convertMesh","signal","reduce","size","y","load","metadata","georeferenced","spatialReference","origin","mesh","isWebMercator","isWGS84","vertexSpace","x","z","u","R","retry","abort","prototype"],"sourceRoot":""}